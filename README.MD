# CKFaceCore

CKFaceServerからサンプルコードとして最も重要なものだけを抽出しました。
これをpullすると、すぐに推論と学習を体験できます。

デフォルトでは３人の判定ができます。

## 準備

1. 必要なディレクトリを作成します。

```
$ mkdir ~/CKFaceCore/Auth ~/CKFaceCore/face ~/CKFaceCore/face.bak ~/CKFaceCore/models 
```

2. face.bakに以下の構成で学習したい画像を入れます。

```
face.bak
├── LABEL1
│   ├── 11.jpg
│   ├── 12.jpg
│   └── 13.jpg
├── LABEL2
│   ├── 21.jpg
│   ├── 22.jpg
│   └── 23.jpg
└── LABEL3
    ├── 31.jpg
    ├── 32.jpg
    └── 33.jpg

```

- **LABEL**には登録する名前を入れてください。例えばKizunaAIを登録したい場合LABELの部分はKizunaAIとなります。
- 一般に、画像枚数は多ければ多いほど精度が上がりますが、その分時間がかかります
- 画像枚数はそれぞれ同じ枚数にしましょう。枚数が異なると、学習が偏る場合があります。
- 例では画像に番号を割り振っていますが、名前はなんでも良いです。
- LABELの数はデフォルトでは3つです。
	- keras_auth.pyの21行目にあるpeopleの値と同じにする必要があります。ここを変えると、推論する人数を変えられます。

3. 学習の準備が整いました。

4. 推論をする場合は、Auth/に画像を入れるだけで良いです。複数枚入れてもOKです。
	- 画像名にラベルと同じ名前をつけると、推論結果が正解かどうか判定できます。(deep learningに関係ありません)

## ディレクトリ

- Auth/:ここに推論したい画像を入れます。
- face/:学習画像を入れます。
- face.bak/:学習画像を入れます。データ拡張する際に学習画像をいじるのですが、いじる前の画像がここに入ってます。初期化する際はこのディレクトリをface/にコピーするので、削除してはいけません。
- model/:学習済みパラメータのファイルが一式入ります。推論の時はここのファイルを読み込みます。


## ファイル

- face_kera.py:学習時はこのコードを実行します。
- keras_auth.py:推論時はこのコードを実行します。
